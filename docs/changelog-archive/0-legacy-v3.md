# 更新日志归档 (v3.x.x)

---

## [3.9.2] - 终极部署指南：社区驱动的连接问题修复 (Ultimate Deployment Guide: Community-Driven Connection Fixes)

### ✨ 新增与优化

- **终极故障排查指南**: 根据社区成员的深度实战反馈，在 `docs/03-TROUBLESHOOTING.md` 中新增了一个详尽的、百科全书式的故障排查条目，专门解决最常见的固件上传失败问题——`开发板在 null 不可用 (Board at null is not available)`。
- **覆盖所有场景**: 新指南提供了一个从上到下的完整诊断流程，包括：
    - **物理层**: 如何判断 USB 线是“充电线”还是“数据线”。
    - **系统层**: 如何使用设备管理器诊断问题。
    - **驱动层**: 提供了针对 `CP210x` 和 `CH9102` 两种芯片的官方驱动下载链接和安装说明，特别是解决了 `CH9102` 驱动带黄色感叹号的疑难杂症。
    - **固件层**: 提供了强制进入 `Bootloader` 模式以恢复设备的备用方案。
- **提升部署成功率**: 本次更新汇集了社区的集体智慧，旨在帮助新用户解决 99% 的硬件连接问题，显著提升首次部署的成功率。

## [3.9.1] - 社区驱动的文档增强 (Community-Driven Docs Enhancement)

### ✨ 新增与优化

- **增强故障排查指南**: 根据社区反馈，在 `docs/03-TROUBLESHOOTING.md` 中新增了一个故障排查条目。该条目详细解释了在编译时可能遇到的 `Rtc_Pcf8563` 库相关的 `-Wwrite-strings` 警告，阐明了其原因、影响（无害），并提供了解决方案，进一步降低了新用户的困惑。

## [3.9.0] - 文档架构重构 (Documentation Architecture Refactor)

### 💥 重大变更

- **文档模块化**: 根据用户建议，对整个文档体系进行了架构重构，以提升可维护性和清晰度。
    - **指南拆分**: `GUIDE.md` 已被拆分为三个独立的、目标明确的模块 (`01-SERVER-SETUP.md`, `02-FIRMWARE-FLASHING.md`, `03-TROUBLESHOOTING.md`)，并存放在新的 `docs/` 目录下。
    - **日志归档**: `CHANGELOG.md` 现在只保留最新版本的更新信息，所有历史版本均已按主版本号归档至 `docs/changelog/` 目录下。
    - **README 简化**: `README.md` 中的版本徽章已被移除，使其成为一个更稳定的项目入口。

## [3.8.4] - 关键固件编译修复 (Critical Firmware Compilation Hotfix)

### 🐞 修复

- **修复固件编译错误**: 根据用户反馈和社区建议，对 `GUIDE.md` 中的固件代码进行了紧急修复，以确保其能够顺利编译。
    - **修正字体数据**: 修正了 `Px437_IBM_BIOS5pt7bBitmaps` 字体数据数组中的一个非法八进制字面量 (typo: `0E7` -> `0xE7`)，该错误会导致 `narrowing conversion` 编译失败。
    - **修正PNG解码宏**: 将与当前环境不兼容的 `PNG_LITTLE_ENDIAN` 宏，替换为了编译器建议的、正确的 `pdLITTLE_ENDIAN` 宏。

## [3.8.3] - 安装指南终极优化 (Ultimate Installation Guide)

### ✨ 新增与优化

- **增强安装指南**: 再次根据社区的深度实战讨论，对 `GUIDE.md` 进行了最终优化，旨在覆盖所有已知的环境配置陷阱：
    - **新增备用开发板选项**: 明确指出如果 `Watchy` 开发板不在列表中，可以选择 `ESP32 Dev Board` 作为替代，解决了部分用户的环境识别问题。
    - **澄清版本选择**: 针对社区讨论中可能产生的版本号困惑，增加了特别说明，再次强调 `2.0.17` 是 `esp32` 核心库的最佳稳定版本。

## [3.8.2] - 社区智慧沉淀 II (Community Wisdom II)

### ✨ 新增与优化

- **增强故障排查指南**: 根据社区成员 (GuruSR, tirefire) 的最新实战排查对话，在 `GUIDE.md` 中新增并增强了多个关键故障排查条目：
    - **新增 "蓝牙OTA卡死" 恢复指南**: 明确了手表卡在 "Watch BLE OTA Waiting for connection..." 屏幕时的唯一恢复方法是重新通过 USB 刷写固件。
    - **新增 `pyserial` 依赖说明**: 增加了在固件上传失败时，可能需要手动安装 `pyserial` Python 依赖的解决方案。
    - **补充设备识别说明**: 增加了“如果电脑将手表识别为 `LilyGo T-Display`，这是正常现象”的提示，以减少用户疑虑。
- **项目清理**: 再次遵循奥卡姆剃刀法则，移除了项目目录中无用的、作为历史遗留的空文件 `index.tsx`。

## [3.8.1] - 安装指南优化 (Installation Guide Optimization)

### ✨ 新增与优化

- **新增中国大陆镜像**: 根据用户建议，为优化中国大陆用户的下载体验，在 `GUIDE.md` 的 Arduino 环境配置部分，为 ESP32 开发板管理器新增了一个 Espressif 官方 Gitee 镜像地址。

## [3.8.0] - 依赖最终锁定 (Final Dependency Lockdown)

### 🐞 修复与优化

- **锁定 `DS3232RTC` 库版本**: 根据社区最新的编译错误反馈，为从根本上解决 `cannot bind non-const lvalue reference...` 错误，本项目现在将 `DS3232RTC` 库的版本**锁定至 `2.0.1`**。
- **强化安装指南**: `GUIDE.md` 已更新，现在明确要求用户安装 **4 个**核心库，并为 `DS3232RTC` 提供了与 `PNGdec` 相同的、详细的手动降级/安装说明。
- **新增故障排查条目**: `GUIDE.md` 的故障排查部分新增了针对 `DS3232RTC` 编译错误的具体条目，帮助用户快速定位问题。
- **提升可靠性**: 这是为确保所有用户都拥有一个稳定、可复现的编译环境所做的最终依赖锁定。

## [3.7.9] - 文档增强：社区智慧沉淀 (Docs: Community Wisdom)

### ✨ 新增与优化

- **增强故障排查指南**: 根据社区成员 (GuruSR, reinhardt021) 的宝贵讨论，在 `GUIDE.md` 中新增并增强了两个关键的故障排查条目：
    - **Linux 串口权限**: 新增了针对 Linux 用户常见的 `Permission denied` 串口连接错误的解决方案，提供了明确的命令行修复指令。
    - **Bootloop 恢复**: 在“固件上传失败”指南中，补充了从固件启动循环（bootloop）中恢复设备的具体方法，强调了必须将上传速率降至 `115200` 才能成功刷入新固件。
- **项目清理**: 移除了项目目录中无用的、作为历史遗留的空文件 `index.tsx`，使项目结构更加干净、更易于理解。

## [3.7.8] - 部署流程简化 (Occam's Razor: Deployment Simplification)

### ✨ 新增与优化

- **简化服务器部署**: 遵循奥卡姆剃刀法则，对本地服务器的部署流程进行了核心简化。
    - **移除 `public` 文件夹**: 本地服务器现在直接从根目录提供 `index.html`，不再需要 `public` 子文件夹。
    - **简化安装指南**: `GUIDE.md` 中关于创建 `public` 文件夹和手动复制 `index.html` 的步骤已被**完全移除**。
- **提升用户体验**: 减少了用户需要执行的手动步骤，显著降低了配置过程中的出错可能性，使整个部署流程更直接、更简洁。
- **项目清理**: 移除了无用的 `index.tsx` 残留文件，使项目结构更干净。

## [3.7.7] - 文档增强：明确 esp32 v3.x.x 兼容性问题 (Docs: Clarify esp32 v3.x.x Incompatibility)

### ✨ 新增与优化

- **增强故障排查指南**: 根据社区最新的编译错误反馈 (GitHub Issue #271)，在 `GUIDE.md` 的“故障排查”部分新增了一个专门针对 `'GPIO_SEL_xx' was not declared in this scope` 错误的条目。
- **明确问题根源**: 指南现在明确解释了此错误是由于使用了不兼容的 `arduino-esp32` v3.x.x 核心库导致的，并阐明了其技术原因（宏定义变更）。
- **强化版本要求**: 再次强调了必须严格使用指定的 `2.0.17` 版本，为用户提供了更精准的错误诊断和解决方案，进一步提升了首次编译的成功率。

## [3.7.6] - 文档增强：新增蓝牙固件更新指南 (Docs: Bluetooth Update Guide)

### ✨ 新增与优化

- **新增备用固件更新方法**: 根据社区用户 @mikkjant 的宝贵经验，在 `GUIDE.md` 的“故障排查”部分，新增了通过网页蓝牙 (Web Bluetooth) 更新 Watchy 固件的详细指南。
- **提供恢复选项**: 此方法为USB刷写遇到困难的用户提供了一个重要的备用方案，尤其适用于恢复因刷写失败而无响应的手表。
- **明确适用范围**: 指南中明确说明了该方法主要用于刷写官方固件，并解释了其作为诊断和恢复工具的价值。

## [3.7.5] - 硬件故障排查文档更新 (Hardware Troubleshooting Docs)

### ✨ 新增与优化

- **新增固件刷写指南**: 根据社区成员的宝贵反馈，在 `GUIDE.md` 的“故障排查”部分新增了一个关键条目，专门解决固件上传失败或导致手表无响应（“变砖”）的问题。
- **提供核心解决方案**: 指南现在明确指出了 `CP210x` 芯片在台式机上可能遇到的电压尖峰问题，并提供了两个经过社区验证的解决方案：
    1.  **优先建议**: 换用**笔记本电脑**进行刷写。
    2.  **备用方案**: 在 Arduino IDE 中将**上传速率 (`Upload Speed`) 降至 `115200`**。
- **提升用户成功率**: 此项更新旨在帮助用户避免一个非常隐蔽且令人沮丧的硬件问题，从而显著提高首次刷写固件的成功率。

## [3.7.4] - 依赖版本锁定与稳定性修复 (Dependency Pinning & Stability Fix)

### 💥 重大变更

- **锁定依赖版本**: 根据 Watchy 官方和社区的深度反馈，为从根本上解决编译不稳定的问题，本项目现在采取依赖版本锁定的策略，优先保证可靠性。
    - **固件代码回退**: 固件代码已回退，以**完全兼容**更稳定、更广泛使用的 `PNGdec` 库 **`v1.0.2`** 版本。
    - **强化安装指南**: `GUIDE.md` 经过大幅更新，现在**强制要求**用户安装特定版本的 `arduino-esp32` (**`2.0.17`**) 和 `PNGdec` (**`v1.0.2`**)。指南中包含了详细的手动降级/安装指定版本库的操作说明。
- **提升可靠性**: 此变更将用户的编译环境标准化，避免了因上游库API变更导致的编译失败，确保了开箱即用的成功率，完美践行了“可靠性优先”的设计原则。

## [3.7.3] - 固件编译兼容性修复 (Firmware Compilation Compatibility Fix)

### 🐞 修复

- **修复 `PNGdec` 库兼容性问题**: 根据用户反馈和编译日志，修复了因 `PNGdec` 库版本更新导致的两个关键编译错误。
    - **回调函数签名**: 将 `pngDraw` 回调函数的返回值从 `void` 修改为 `int`，并返回 `1` 表示成功，以符合新版库API的要求。
    - **修正宏定义**: 将已废弃的 `PNG_LITTLE_ENDIAN` 宏替换为编译器建议的 `pdLITTLE_ENDIAN`，解决了标识符未定义的错误。
- **同步文档**: `GUIDE.md` 中的固件代码已同步更新为可编译的最新版本。

## [3.7.2] - 服务器代码优化 (Server-side Optimization)

### ✨ 优化

- **移除冗余中间件**: 根据社区建议，移除了本地服务器中 `express.json()` 这个JSON请求体解析中间件。由于项目的数据流已完全转为二进制，该中间件已无实际作用。此举简化了代码并减少了不必要的处理开销。
- **优化静态文件服务**: 将通用的 `express.static` 中间件，替换为了一个目的更明确、效率更高的特定路由 `app.get('/')` 来服务主页面。对于仅有一个静态文件的本项目而言，这是一种更精简、更高效的实现方式。

## [3.7.1] - 固件健壮性增强 (Firmware Robustness)

### 🐞 修复与优化

- **增加解码过程验证**: 在固件中增加了对 `png.decode()` 解码步骤的返回值检查。现在，如果固件从服务器收到了损坏或无效的PNG数据，它将能正确处理该错误，并在屏幕上显示一个明确的 `PNG Decode Failed` 提示，而不是潜在地导致未定义行为。
- **修正错误提示逻辑**: 修复了一个长期存在的逻辑错误，即当打开PNG数据流失败时（`openFLASH()` 失败），错误地显示了“解码失败”。现已修正为更准确的 `PNG Open Failed`，使故障排查更直观。
- **提升健壮性**: 这两项改动共同提升了固件在处理网络数据异常时的健壮性，使设备运行更可靠。

## [3.7.0] - 前向兼容性修复与依赖削减 (Forward Compatibility & Dependency Reduction)

### 💥 重大优化与修复

- **固件前向兼容性**: 根据社区反馈，对固件代码进行了重构，以**完全兼容最新版本 (v1.16+) 的 `PNGdec` 库**。
    - **API 适配**: 将代码中的类名从 `PNGdec` 更新为 `PNG`，并将已废弃的 `getLineAs16BPP()` 函数调用替换为新版的 `getLineAsRGB565()`。
    - **解决编译错误**: 此项改动彻底解决了因库版本更新导致的编译失败问题，使用户无需再手动降级库版本。
    - **提升可维护性**: 确保了项目对 `PNGdec` 库未来更新的兼容性，提升了长期可维护性。
- **服务器依赖削减**: 采纳社区建议，移除了本地服务器的 `dotenv` 依赖，使项目更加轻量。
    - **简化部署**: API 密钥现在通过标准的**环境变量**在启动服务器时直接传入，取代了原有的 `.env` 文件机制。
    - **更新启动指南**: `GUIDE.md` 中的服务器启动说明已完全重写，为不同操作系统（Mac/Linux/Windows）提供了清晰的命令行启动指导。

## [3.6.1] - 固件编译修复 (Firmware Compilation Hotfix)

### 🐞 修复

- **修复关键编译错误**: 根据用户反馈，修复了一个因变量名 (`png`) 与其类型名 (`PNGdec`) 冲突而导致的 C++ 编译错误。已将解码器对象重命名为 `pngObject`，确保固件在标准 Arduino 环境下能够成功编译。
- **更新版本号**: 固件内部版本号已同步更新至 `3.6.1`。

## [3.6.0] - 架构重构：移除Base64，实现端到端二进制传输 (Architectural Refactor: End-to-End Binary Transfer)

### 💥 重大优化

- **移除Base64依赖**: 对整个数据传输链路进行了重构，彻底移除了对Base64编码的依赖。图片现在作为原始二进制数据（`image/png`）在Web UI、服务器和Watchy固件之间传输。
- **Web UI 优化**: 前端现在使用`canvas.toBlob()`生成二进制图片，并通过`fetch`直接发送，取代了之前效率较低的`toDataURL()`方法。
- **服务器逻辑简化**: 本地服务器 (`server.js`) 更新为使用`express.raw()`中间件来处理二进制请求体，直接在内存中存储和转发图片的二进制`Buffer`。
- **固件性能提升**: Watchy固件代码被大幅简化，移除了`Base64`库依赖和解码步骤。现在固件直接将从服务器接收到的二进制数据流送入PNG解码器。

### ✨ 核心收益

- **可靠性与性能**: 通过消除在资源受限的ESP32设备上的解码步骤，显著降低了CPU和内存的负担，从而提升了更新速度、降低了功耗，并增强了长期运行的稳定性。
- **代码简化**: 移除了一个库依赖和相关的编解码逻辑，使固件代码更精简、更易于维护，也简化了新用户的部署步骤。
- **遵循设计原则**: 本次重构完美践行了项目的“简单至上”和“可靠性优先”原则，将复杂性从嵌入式设备中移除，实现了更高效、更健壮的系统架构。

## [3.5.3] - 文档重构：回归务实与工程精神 (README Refactor for Utility)

### ✨ 新增与优化

- **重写 README.md**: 根据用户反馈，对主 `README.md` 文件进行了再次重写，完全移除了“宣言”式的浮夸语言，回归到一种谦逊、务实且以用户为中心的工程文档风格。
- **聚焦实用价值**: 新版 README 更加直接地说明了项目“是什么”以及它“解决了什么问题”。
- **强化技术阐述**: “设计原则”部分现在由代码和版本历史中的具体决策（例如，从React重构到原生JS、引入硬件看门狗）来支撑，使其更具说服力和技术深度，而不再是空洞的口号。
- **优化信息结构**: 通过更清晰的流程图和FAQ，新文档旨在为用户提供最大化的实用价值，帮助他们快速理解项目架构并解决常见问题。

## [3.5.2] - 文档重构：项目哲学宣言 (README Overhaul & Philosophy)

### ✨ 新增与优化

- **重写 README.md**: 根据用户的设计哲学和项目演进思路，对主 `README.md` 文件进行了彻底的重写。
- **阐述核心设计理念**: 新版 README 不再仅仅是功能介绍，而是一份项目“宣言”。新增了“项目哲学”章节，详细阐述了驱动本项目开发的三大核心原则：**“实用主义胜于复杂”**、**“稳定性是核心特性”**和**“用户成功至上”**。
- **提升文档价值**: 通过全面优化结构、文案和视觉元素，新的 README 旨在更深刻地传递项目的价值主张、技术决策背后的思考以及对用户体验的承诺，为潜在贡献者和用户提供了更丰富的上下文。

## [3.5.1] - 编译问题修复与指南增强 (Compilation Hotfix)

### 🐞 修复与优化

- **增强安装指南**: 针对用户反馈的编译错误，大幅更新了 `GUIDE.md`。新增了专门的“故障排查”章节，提供了针对 `std::vector`, `base64`, `not-allowed` 等常见错误的详细解决方案。
- **强调环境一致性**: 指南中现在用更醒目的方式强调了必须使用指定的 ESP32 Core 版本 (`2.0.14`) 和从库管理器安装正确的依赖库，以从根源上避免工具链和依赖冲突。
- **澄清代码使用方法**: 在指南中增加了重要提示，要求用户必须将固件代码完整复制到一个**全新的、空白的** Arduino 项目中，以防止与用户本地的其他代码或 `WiFiManager` 等不相关的库产生冲突。

## [3.5.0] - 视觉与代码结构优化 (AUTHENTIC DOS)

### ✨ 新增与优化

- **恢复经典DOS字体**: 重新引入 `Px437_IBM_BIOS` 像素字体，还原最真实的DOS怀旧风格，解决了v3.2.1版本为兼容性移除字体后视觉效果不佳的问题。
- **优化固件代码结构**: 吸收社区建议，在 `GUIDE.md` 中更新了固件代码。通过内联定义 `settings` 结构体和修正 `Base64` 库的调用方式，大幅提升了代码在标准Arduino环境下的编译成功率。
- **视觉细节调整**: 更新了屏幕上显示的固件版本号，并微调了文本布局以适配新的像素字体。
- **简化安装流程**: 由于字体数据已直接嵌入固件代码，`GUIDE.md` 中关于下载和安装自定义字体的步骤已被移除，进一步简化了用户的设置流程。

## [3.4.0] - 终极稳定性增强 (ULTIMATE STABILITY)

### ✨ 新增与优化

- **引入硬件看门狗 (WDT)**: 确保设备在主任务（如WiFi操作）意外卡死时能自动重启，为无人值守的长期运行提供了终极的可靠性保障。
- **整合配置项**: 将所有用户设置（WiFi、服务器地址）和系统常量（固件版本、超时）归类到代码顶部的同一个配置块中，极大地方便了用户的修改和后续维护。
- **增强架构注释**: 在代码中增加了关键的架构决策注释，用于解释为何采用静态缓冲区（防止内存碎片）和硬件看门狗（保证长期稳定）等最佳实践。

## [3.2.2] - 关键固件编译修复

### 🐞 修复

- **修复核心编译错误**: 根据用户提供的编译日志，修复了一个长期存在的、导致编译失败的核心 bug。固件代码中 `pngDraw` 回调函数错误地使用了 `display`（应为 `Watchy::display`）且错误地访问了 `pDraw->x` 成员。现已将其完全修正，确保代码在用户环境中能够成功编译。

## [3.2.1] - 固件兼容性修复

### 🐞 修复

- **移除自定义字体**: 根据用户反馈，为解决固件编译问题，移除了对外部 `Px437_IBM_BIOS` 字体的依赖。
- **使用默认字体**: 固件现在使用 Watchy/Adafruit GFX 库的内置默认字体。这确保了固件在标准 Arduino 环境下无需额外配置即可成功编译，优先解决了可用性问题。
- **更新安装指南**: `GUIDE.md` 中的固件准备步骤已同步更新，移除了下载和添加自定义字体文件的相关说明，简化了新用户的设置流程。

## [3.2.0] - 固件稳定性与代码重构

### 💥 重大优化

- **重构固件核心逻辑**: 为了追求更高的稳定性和代码质量，对 Watchy 固件的核心数据获取与解码逻辑进行了彻底重构。
- **提升内存管理与稳定性**:
    - **弃用 `http.getString()`**: 彻底移除了高风险的 `http.getString()` 调用，该调用是导致内存碎片和长期运行不稳定的主要原因。
    - **引入流式处理**: 采用 `HTTPClient` 的流式处理 (`getStream()`) 和 `Base64` 的流式解码，直接将网络数据流解码到内存缓冲区。此举**从根本上避免了堆碎片化**，显著提升了固件的长期运行稳定性。
- **提升代码简洁性与可维护性**:
    - **简化 `drawAiNote`**: 重构了 `drawAiNote` 函数，通过新的流式逻辑减少了内存分配的次数和 `if` 嵌套的层级，使代码更线性、更易于理解。
    - **引入常量**: 将所有用于布局的“魔法数字”（如 `66`, `200`）定义为具名常量，增强了代码的可读性和未来维护的便利性。
    - **增加内存分配失败提示**: 新增了在 `malloc` 失败时显示 `Mem. Alloc Failed` 错误的功能，增强了固件的故障排查能力。

## [3.1.3] - 关键固件编译修复

### 🐞 修复

- **修复核心编译错误**: 根据用户提供的编译日志，修复了一个长期存在的、导致编译失败的核心 bug。固件代码中 `pngDraw` 回调函数错误地使用了 `pDraw->x`（`PNGdec` 库的 `PNGDRAW` 结构体中不存在此成员）。现已将其修正为 `0`，确保代码能够成功编译并通过。为之前的疏忽致歉。

## [3.1.2] - 关键链接修复

### 🐞 修复

- **修复字体下载链接**: 根据用户反馈，`GUIDE.md` 中的字体文件下载链接因上游仓库结构变更已失效 (404 Not Found)。现已更新为指向 `watchy-faces` 仓库的正确、有效的链接，确保新用户可以顺利完成固件准备步骤。

## [3.1.1] - 安装指南健壮性优化

### ✨ 新增与优化

- **优化字体下载说明**: 根据用户反馈，`GUIDE.md` 中关于字体文件下载的说明已被大幅增强。针对浏览器可能直接显示文本而不是下载文件的问题，新增了更详细的操作步骤和两种备用下载方法（“链接另存为”和“页面另存为”），并强调了检查文件名的重要性，以确保用户能够顺利完成此关键步骤。

## [3.1.0] - 固件代码修复与安装指南增强

### 💥 重大修复

- **修复固件编译错误**: 根据最新的 `Watchy` 库 API，重构了手表固件的 C++ 代码。修正了因构造函数不匹配而导致的编译失败问题，确保代码能在现代 Arduino 环境下顺利编译。

### ✨ 新增与优化

- **明确 ESP32 版本**: 根据用户反馈和稳定性测试，`GUIDE.md` 中的 ESP32 开发板核心版本已明确指定为 `2.0.14`，以避免潜在的兼容性问题。
- **完善库依赖列表**: 在安装指南中增加了 `GxEPD2` 库，为用户提供了更完整的必要依赖列表。
- **优化字体安装说明**: `GUIDE.md` 中关于如何添加自定义字体文件的步骤已被重写，提供了更清晰、更不易出错的手动创建文件夹的指导。
- **修正电池续航提示**: 澄清并修正了关于修改唤醒间隔以延长电池续航的说明。旧的提示指向一个不存在的常量，新的说明准确地解释了默认的1分钟唤醒机制，并为高级用户提供了修改 `Watchy` 库以实现长续航的正确方法。

## [3.0.9] - 部署指南健壮性修复

### 🐞 修复与优化

- **修正部署文档**: 根据用户在实际部署中遇到的麦克风权限问题，对 `GUIDE.md` 进行了关键性修正。
- **明确访问方式**: 指南现在明确区分了两种 Web UI 的访问方式：
    - **本机访问 (推荐)**: 强调应在本机使用 `http://localhost:3000` 进行访问，以符合浏览器的安全策略，确保麦克风功能可用。
    - **局域网访问**: 解释了通过 IP 地址访问时，可能会因安全策略导致麦克风被禁用，并看到 `not-allowed` 错误。
- **新增故障排查**: 在“故障排查”部分，新增了一个专门针对 `ERROR: not-allowed` 的条目，详细解释了问题背后的“安全上下文”原因，并提供了 `localhost` 解决方案，帮助用户更好地理解和解决部署中遇到的权限问题。

## [3.0.8] - 安装指南重构

### ✨ 新增与优化

- **重写安装指南**: 根据用户的部署需求，对核心的 `GUIDE.md` 安装指南进行了彻底的重写。
- **提升清晰度**: 新指南提供了更清晰、更详尽、对零基础用户更友好的分步说明，涵盖了本地服务器搭建、Web UI部署和Watchy固件刷写的全过程。
- **强调关键点**: 文档现在更加强调了配置过程中的关键点（如 `.env` 文件创建、IP地址填写）和最常见的故障排查场景（如防火墙设置），以确保用户部署过程的顺利进行。
- **代码同步**: 指南中的所有代码、命令和文件结构都已更新，与当前 v3.0.7 版本的项目实现完全同步。

## [3.0.7] - 核心逻辑解耦与健壮性修复

### 🐞 修复

- **修复预览依赖服务器的Bug**: 根据用户的精准反馈，修复了一个核心逻辑Bug。此Bug导致在本地服务器未运行时，即时AI摘要成功，Web UI也无法显示备忘录预览。
- **解耦处理流程**: 对核心的 `processTranscript` 函数进行了重构，将“AI摘要”与“服务器同步”两个步骤完全解耦。
    - **预览优先**: 现在，AI摘要成功后会**立刻**更新UI预览，确保用户能即时看到结果。
    - **隔离服务器错误**: 服务器连接失败现在只会在状态栏显示错误提示，而**不会**再影响或清空已经成功生成的备忘录内容和预览。
- **提升健壮性**: 这次修复确保了Web UI的预览功能完全独立于服务器的状态，显著提升了应用的健性和用户体验的直观性。

## [3.0.6] - 交互健壮性与文档完善

### 🐞 修复与优化

- **优化错误提示**: 针对用户最常遇到的“服务器连接超时”问题，优化了 Web UI 中的错误提示。现在，当发生此特定错误时，UI会显示一条更具指导性的消息，建议用户“检查服务器/防火墙”，并参考 `GUIDE.md` 进行排查，为用户提供了清晰的下一步操作指引。
- **完善安装指南**: 在 `GUIDE.md` 文件中新增了**“第四部分：故障排查”**。这个新部分专门用于帮助用户解决最常见的网络连接问题，特别是针对 `Server connection timed out` 错误，提供了关于“服务器未运行”、“防火墙拦截”和“网络不匹配”三种情况的清晰、可操作的解决方案。

## [3.0.5] - 代码逻辑重构与极简化

### 🐞 修复与优化

- **代码逻辑重构**: 根据用户对“极简代码”和“降低复杂度”的追求，进行了一次彻底的代码逻辑重构。
- **引入 `withTimeout` 辅助函数**: 创建了一个可复用的 `withTimeout` 辅助函数，将所有重复、复杂的超时逻辑（包括 `Promise.race`, `setTimeout`, 和 `AbortController`）进行了统一的抽象和封装。
- **简化核心函数**: 核心的 AI 请求 (`runMemoGeneration`) 和服务器同步 (`sendImageToWatchyServer`) 函数现在调用这个辅助函数，使得它们自身的代码变得极其简洁、清晰，只关注其核心职责。
- **提升代码质量**: 这次重构显著降低了代码的整体复杂度和维护成本，提升了代码的可读性和健壮性，完美贯彻了项目的“极简”原则。


## [3.0.4] - 极简主义原则贯彻

### 🐞 修复与优化

- **移除字体加载服务**: 根据用户对“极简”原则的强调，移除了用于解决字体闪烁（FOUT）的 `document.fonts.ready` API 调用。我们接受 FOUT 作为一种正常的、可预期的浏览器行为，以此来简化代码，消除一个非必要的复杂层，确保项目的绝对精简。
- **精简文档**: 重新审阅并修正了 `README.md` 文件。移除了“技术栈”部分对旧版 React/TypeScript/Tailwind 架构的过时引用，使其准确地反映当前**“原生 HTML, CSS, JavaScript”**的极简技术实现，确保文档与代码的完全一致。

## [3.0.3] - 字体稳定性与交互健壮性修复

### 🐞 修复

- **修复时钟字体“闪烁” (FOUT) 问题**: 根据用户的精准反馈，修复了 Web UI 在初始加载时，时钟字体会先显示为系统默认字体，再“闪烁”成目标像素字体的视觉问题。通过引入 `document.fonts.ready` API，确保了在所有自定义字体完全加载并准备就绪之前，不会进行任何 canvas 绘制操作，**从根本上消除了字体闪烁**，保证了视觉体验的一致性。
- **彻底修复按钮卡死 Bug (最终版)**: 针对在极端网络条件下，按钮依然可能卡在 "PROCESSING..." 状态的顽固 Bug，引入了**“主流程超时”**的最终解决方案。
- **引入主流程超时**: 整个处理流程（从 AI 摘要到服务器同步）现在被一个 **20 秒**的“主流程超时”包裹。如果流程中的任何一步因网络问题被“永久挂起”，这个最终保险会强制触发一个超时错误。这确保了 `finally` 代码块总能被执行，从而**保证按钮在任何可预见的极端情况下，都能 100% 可靠地恢复到初始状态**。

## [3.0.2] - 交互健壮性与反馈系统重构

### 🐞 修复

- **彻底修复按钮卡死 Bug**: 根据用户的精准反馈，修复了在网络状况不佳时，按钮会永久卡在 "PROCESSING..." 状态的严重 Bug。问题的根源在于对 Gemini API 的网络请求没有超时机制，可能导致程序无限期挂起。
- **引入 AI 请求超时**: 通过为 AI `generateContent` 请求增加一个 **10 秒的超时**，确保了即使在网络连接无响应的情况下，程序也能正确地捕ায়ত্ত错误并继续执行，从而**保证按钮在任何情况下都能可靠地恢复到初始状态**。

### ✨ 新增与优化

- **多阶段状态反馈**: 为解决状态提示信息冗余、无效的问题，重构了状态提示系统。现在，处理流程会分步向用户报告进度，提供了清晰、有价值的增量信息：
    - `> Summarizing with AI...` (AI 总结中...)
    - `> Syncing with server...` (同步到服务器中...)
    - `> Memo synced to server.` (备忘录已同步。)
- **精确的错误报告**: 当处理流程失败时，状态栏现在会显示具体的错误原因，例如 `> ERROR: AI request timed out.` 或 `> ERROR: Server connection failed.`，为用户提供了更明确的故障排查指引。

## [3.0.1] - 时钟区域字体统一

### ✨ 新增与优化

- **统一时钟字体**: 根据用户反馈，为解决预览中因自定义字体加载不稳定而导致的字体风格冲突与“别扭感”，将时钟区域的字体进行了统一。
- **视觉和谐**: 移除了不稳定的 `DSEG7 Classic` 七段数码管字体，将**整个**上半部分（包括大尺寸的时间和下方的日期）的字体，全部统一为稳定、可靠且风格一致的 `Press Start 2P` 像素字体。
- **布局优化**: 重新调整了时间和日期的字号与间距，使其在统一的像素风格下，依然保持清晰的主次关系和视觉平衡感。这创造了一个风格高度统一的“原生时钟”区域，与下方的“图片备忘录”区域形成了和谐且逻辑清晰的对比。

## [3.0.0] - "奥德赛" 表盘风格重构

### 💥 重大变更

- **视觉风格重构**: 根据用户提供的实物表盘图片，对 Web UI 的 Watchy 预览进行了代号为“奥德赛” (Odyssey) 的重大视觉重构，以精确复刻其复古科技感风格。

### ✨ 新增与优化

- **引入全新时钟字体**: 为了完美再现图片中的七段数码管（7-Segment Display）效果，项目引入并集成了 `DSEG7 Classic` 字体。预览中的时间显示现在拥有了与实物一致的、充满复古电子感的大尺寸外观。
- **复刻日期布局**: 参照图片，在巨大的时钟下方，使用经典的 `Press Start 2P` 像素字体，重新模拟了日期和星期，使其在风格和布局上都与新的时钟设计和谐统一。
- **高保真预览**: 预览画布的背景和元素颜色经过微调，以更精确地模拟 E-Ink 屏幕的质感。

### 🧹 维护

- **架构一致性**: 本次更新严格遵守了“原生时钟模拟+图片备忘”的核心架构。发送给服务器的依然**只是**代表备忘录区域的下半部分图片，确保了与现有 Watchy 固件的完美兼容。