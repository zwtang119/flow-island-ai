# 更新日志归档 (v1.x.x & v2.x.x)

---

## [2.9.9] - 核心架构修正与高保真预览

### 💥 重大变更

- **核心架构修正**: 根据用户的关键反馈，彻底重构了图片生成逻辑，以符合“原生时钟+图片备忘”的正确架构。现在，Web UI **只生成并发送**代表备忘录区域的下半部分图片 (`200x134` 像素)，而不再是整个表盘。这大大降低了数据传输量，并遵循了 Watchy 开发的最佳实践。

### ✨ 新增与优化

- **高保真预览**: Web UI 的预览画布 (`<canvas>`) 已被重写，现在能够**精确地模拟**手表上的最终显示效果：
    - **上半部分**: 使用像素字体模拟 Watchy **硬件原生渲染**的时钟和日期。
    - **下半部分**: 实时绘制从 AI 摘要新生成的那张备忘录图片。
- 这确保了用户在网页上看到的预览与手表上的实际效果**完全一致**。

### 🧹 维护

- **固件代码确认**: 重新审阅了 `GUIDE.md` 中的 C++ 固件代码，并确认其设计**本身就是正确的**，无需任何修改。本次变动仅修正了 Web UI 的实现偏差。

---

## [2.9.8] - 视觉和谐与布局恢复

### ✨ 新增与优化

- **布局比例调整**: 根据用户反馈，将 Watchy 预览画布的布局恢复为更经典的 **1/3 时钟 + 2/3 备忘录** 的垂直比例，为备忘录区域提供了更充足的空间。
- **全局字体统一**: 为追求极致的视觉和谐感，将**整个 Watchy 预览画布**（包括顶部的日期、时钟）的字体**全部统一为标准的无衬线黑体**，移除了所有像素风格字体，确保了从上到下所有字符都拥有一致、现代且清晰的视觉风格。

---

## [2.9.7] - 布局优化、AI强化与顽固Bug修复

### ✨ 新增与优化

- **优化屏幕布局**: 重新调整了 Watchy 预览画布的垂直空间分配。现在，顶部的**日期和时钟区域精确占据屏幕的 1/4**，为下方的**备忘录区域留出了更宽敞的 3/4 空间**，显著提升了备忘录的可读性。
- **强化 AI 摘要指令**: 进一步优化了给 AI 的提示词 (Prompt)，现在更加明确地指示 AI 在总结多件事情时，必须将**每个独立的任务点强制换行**，以生成格式更清晰的列表。

### 🐞 修复

- **彻底修复按钮卡死 Bug**: 修复了在网络状况不佳时，按钮会卡在“Processing...”状态的顽固 Bug。通过为向本地服务器发送图片的网络请求**增加了一个8秒的超时机制**，确保了即使服务器无响应，程序也能正确处理错误，并**保证按钮在任何情况下都能可靠地恢复到初始状态**。

---

## [2.9.6] - 交互反馈、视觉统一与稳定性修复

### ✨ 新增与优化

- **新增状态提示**: 在录音按钮下方增加了一个专用的状态提示行。现在，无论是同步成功，还是遇到任何错误（AI摘要失败、网络连接中断、服务器无响应等），都会给出清晰、即时的文本反馈。
- **统一备忘录字体**: 为了解决中英文、数字混合显示时的不和谐感，将 Watchy 预览画布中**备忘录区域**的字体统一指定为标准的无衬线黑体，确保了所有字符的视觉风格统一、清晰。

### 🐞 修复

- **彻底修复按钮卡死 Bug**: 修复了核心交互流程中的一个严重 Bug。通过将阻塞性的 `alert()` 错误提示替换为全新的**非阻塞式状态文本**，确保了无论处理成功或失败，录音按钮都能够**立即、可靠地**恢复到初始状态，不再卡死。

---

## [2.9.5] - 本地化与稳定性修复

### ✨ 新增与优化

- **AI 摘要本地化**: 更新了核心 AI 提示词，现在明确要求 AI 使用**中文**进行内容摘要，以更好地服务中文用户。
- **备忘录扩容**: 根据用户反馈，将 Watchy 预览画布中的备忘录最大显示行数恢复到 **6 行**，并放宽了对 AI 生成文本的字数限制，允许承载更丰富的内容。

### 🐞 修复

- **彻底修复“Processing...”卡死 Bug**: 重构了整个处理流程的错误捕获与状态管理机制。现在，所有类型的错误（包括 AI 摘要失败、网络连接中断、服务器响应错误等）都会被统一处理，并**确保按钮状态在任何情况下都能可靠地恢复**到初始状态，彻底解决了UI卡死的严重问题。

---

## [2.9.4] - AI 多任务摘要与录音逻辑修复

### ✨ 新增与优化

- **AI 提示词增强**: 彻底优化了发送给 Gemini API 的核心提示词 (Prompt)。新的指令明确引导 AI 在处理多个任务时使用数字列表格式进行摘要，并提供了相应的示例。这显著提升了对多件事情进行正确、清晰总结的能力。

### 🐞 修复

- **录音流程**: 修复了录音会自动停止以及处理后按钮状态不正确的问题。现在，录音会持续进行，直到用户手动点击“停止录音”按钮，确保了完整的语音输入。同时，按钮状态管理更加可靠，不会再卡在“处理中”的状态。

---

## [2.9.3] - 备忘录布局微调

### ✨ 新增与优化

- **备忘录行数调整**: 根据用户反馈，为达到更好的视觉平衡，将 Watchy 预览中的备忘录最大显示行数从6行减少到4行。

---

## [2.9.2] - 健壮性修复与备忘录扩容

### 🐞 修复

- **处理流程卡顿**: 修复了在本地服务器未运行时，发送图片失败会导致处理流程卡在“Processing...”状态的问题。现在即时服务器连接失败，UI 也会正确重置按钮状态，不再卡顿。

### ✨ 新增与优化
- **备忘录扩容**: 增加了 Watchy 预览画布中备忘录区域的显示行数，从最多5行增加到6行，允许显示更长的备忘录内容。

---

## [2.9.1] - UI精修与高保真预览

### ✨ 新增与优化

- **纯粹像素风格**: 根据用户反馈，UI已彻底转为纯粹的黑白灰像素风格，移除了所有彩色元素和辉光效果，以达到极致的复古感。
- **高保真Watchy预览**:
    - **模拟E-Ink屏**: 预览画布的背景色已调整为浅灰色，文本为纯黑色，以精确模拟真实Watchy电子墨水屏的显示效果。
    - **设备边框**: 为预览画布增加了黑色边框，使其看起来更像一个真实的设备。
- **DOS风格按钮**: 重新设计了录音按钮，采用了 `> ... <` 字符化设计，使其更符合整体的命令行美学。
- **DOS风格页脚**: 在界面底部重新添加了 `(c) Codewalking` 页脚，以保持风格统一。
- **标题像素感强化**: 调整了CSS以增强主标题的像素感。

### 🧹 维护

- **版本号策略调整**: 采纳用户建议，后续的UI微调将作为修订版本号（如 `x.x.1`）进行更新。

---

## [2.9.0] - UI布局微调与预览修复

### ✨ 新增与优化

- **UI 布局调整**: 对界面元素的位置和大小进行了精细调整，以获得更好的视觉平衡和操作流。
    - **增大标题**: 显著增大了 "AI 便利贴" 标题的字号。
    - **居中按钮**: 将录音按钮在垂直方向上居中，使其成为视觉焦点。
    - **预览置底**: 将 Watchy 预览画布移至“控制台”区域的最下方。
- **Watchy 预览修复**: 修正了预览画布中时钟和日期文本因垂直间距不足而导致的重叠问题，现在两者显示清晰。

### 🧹 维护

- **版本号同步**: 应用内版本号已更新至 v2.9.0。

---

## [2.8.0] - “复古终端”UI 优化

### ✨ 新增与优化

- **全新UI主题**: 引入了“复古终端”深色主题，具有绿色辉光文本和扫描线背景效果，以增强科技感和沉浸感。
- **动态录音指示器**: 为录音按钮增加了麦克风图标，并在录音时添加了红色的“呼吸”动画，提供了更清晰的状态反馈。
- **布局简化**: 移除了预览画布上方的 "Watchy 预览" 标题，使界面更加简洁。

### 🧹 维护

- **文档修正**: 修正了 `README.md` 文件中过时的技术栈信息，将其更新为当前正确的 "原生 HTML, CSS, JavaScript"。
- **版本号同步**: 应用内版本号已更新至 v2.8.0。

---

## [2.7.0] - Watchy 预览时钟风格更新 (Base Style)

### ✨ 新增与优化

- **预览时钟风格重构**: 根据用户要求，将Watchy预览画布中上半部分的时钟显示从原有的DOS命令行风格，重构为更具现代感和可读性的“Base”基础表盘风格。
- **大字体时间**: 新的时钟使用大号像素字体来显示时间，使其成为视觉焦点。
- **新增日期显示**: 在时间上方增加了“星期, 月 日”格式的日期，使预览信息更完整。

### 🧹 维护

- **版本号同步**: 应用内版本号已更新至 v2.7.0。

---

## [2.6.0] - UI简化与预览重构

### ✨ 新增与优化

- **统一录音按钮**: 根据用户要求，将“开始”和“停止”按钮合并为一个动态切换的按钮，简化了操作流程。
- **移除文本日志**: 移除了界面上的文本输出框，使整体设计更加简洁，聚焦于核心的 Watchy 预览。
- **Watchy预览重构**: 完全重写了`<canvas>`的绘制逻辑，以精确模拟真实表盘。
    - **严格分区**: 界面现在严格遵循“上1/3为时钟系统信息，下2/3为备忘录”的布局。
    - **内容保真**: 上半部分的文本内容和布局现在与固件的显示效果更一致。
    - **所见即所得**: 备忘录区域能准确反映有内容和无内容时的状态。

### 🧹 维护

- **版本号同步**: 应用内版本号已更新至 v2.6.0。

---

## [2.5.0] - 统一UI与响应式重构

### ✨ 新增与优化

- **统一UI风格**: 根据用户“一个UI风格适配多种形态”的要求，将所有核心交互元素（标题、按钮、输出、预览）整合进一个统一的“控制台”布局中，创造了单一、内聚的用户体验。
- **移动优先响应式**: 采用了移动优先的流式布局。界面在小屏设备上以单列呈现，在桌面端则优雅地居中，实现了跨设备体验的一致性。
- **布局简化**: 简化了CSS和响应式逻辑，使代码更易于维护。

### 🧹 维护

- **版本号同步**: 应用内版本号已更新至 v2.5.0。

---

## [2.4.0] - 品牌更新与响应式布局

### ✨ 新增与优化

- **品牌更新**: Web UI 的页头已更新为 "AI 便利贴"，页脚更新为 "Codewalking"，并调整了相关风格以注入科技感。
- **响应式 UI**: 添加了媒体查询 (`media queries`) 以优化移动端视图。现在，应用在小屏幕设备上拥有更合适的字体大小和边距，提升了跨设备的用户体验。
- **色彩微调**: 将信息提示文本的颜色调整为亮绿色，以符合新的科技感美学。

### 🧹 维护

- **版本号同步**: 应用内版本号已更新至 v2.4.0。

---

## [2.3.0] - 视觉风格重构 (OK Computer)

### ✨ 新增与优化

- **视觉风格彻底更新**: 根据用户提供的 "OK Computer" 风格图片，Web UI 已完全重构。
    - **背景与配色**: 采用浅灰色背景 (`#f0f0f0`) 和黑色像素文本，忠实还原参考图的视觉感受。
    - **像素字体**: 引入 "Press Start 2P" 像素字体，应用于所有文本元素，确保风格统一。
    - **页头与页脚**: 更新了主标题为 "ü OK Computer"，并添加了 "Powered by KIMI" 页脚。
- **UI 元素重制**: 按钮、日志区域和预览区域的样式已更新，以匹配全新的像素化、复古美学。

### 🧹 维护

- **版本号同步**: 应用内版本号已更新至 v2.3.0。

---

## [2.2.0] - UI/UX Redesign

### ✨ 新增与优化

- **UI 彻底重构**: Web UI 的外观已完全重新设计，采用现代、简洁的“OK Computer”风格深色主题，以提升用户体验。
- **Watchy 预览增强**: 预览画布 (`<canvas>`) 现在能渲染一个**完整的、更真实的** DOS 风格表盘。
    - **上半部分**: 显示静态的 DOS 标题和**实时更新的数字时钟**。
    - **下半部分**: 保留用于显示 AI 生成的便利贴内容。

### 🧹 维护

- **代码优化**: 调整了样式表和脚本，以实现新的布局和功能。

---

## [2.1.0] - 项目清理

### 🧹 维护

- **清理项目结构**: 移除了所有来自 v1.0.0 React/TypeScript 架构的过时文件，包括 `index.tsx`, `App.tsx`, `types.ts`, 以及 `components/`, `hooks/`, `services/` 目录。这最终完成了向轻量级 MVP 架构的过渡。

---

## [2.0.0] - MVP 架构重构

### 💥 重大变更

- **MVP 架构重构**: 根据用户反馈，为简化技术栈和方便维护，项目前端已从 **React/TypeScript** 重构为**原生 HTML/CSS/JavaScript**。

### ✨ 新增与优化

- **前端简化**: 整个 Web UI 现在由一个独立的 `index.html` 文件驱动，直接使用原生浏览器 API。
- **AI 调用**: 保留了通过 Web Speech API 进行语音识别，并直接调用 Gemini API进行文本摘要的核心功能。

### 🗑️ 移除

- **移除依赖**: 不再需要 React, TypeScript, Tailwind CSS, 以及复杂的前端构建流程。

---

## [1.0.0] - 初始版本

### ✨ 初始版本

- **发布**: "AI 便利贴 for Watchy" 初始版本。
- **技术栈**: 前端使用 React, TypeScript, 和 Tailwind CSS。
- **核心功能**:
    - 通过 Gemini Live API 实现实时语音转录。
    - 通过 Gemini API 实现文本摘要。
    - 动态生成 DOS 风格图片并在手表预览中显示。
    - 通过本地 Node.js 服务器将图片同步至 Watchy 设备。